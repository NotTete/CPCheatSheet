\chapter{Number theory}

\section{Modular arithmetic}
	%\kactlimport{ModularArithmetic.h}
	\kactlimport{euclid.h}
	% \kactlimport{Euclid.java}
	\subsection{Bézout's identity}
	$$ax+by=d$$
	If $(x,y)$ is one solution, then all solutions are given by
	$$\left(x+\frac{kb}{\gcd(a,b)}, y-\frac{ka}{\gcd(a,b)}\right), \quad k\in\mathbb{Z}$$

	\kactlimport{ModInverse.h}
	\kactlimport{ModMulLL.h}
	\kactlimport{CRT.h}
	\kactlimport{ModLog.h}
	\kactlimport{ModSum.h}
	\kactlimport{ModSqrt.h}
	\kactlimport{PrimRoot.h}
	
	\subsection{Digital Root}
	Given an integer $n$ and a base $b$. We call the digital root,$db_b(n)$, of $n$ the sum of its digits in the base b:
	$db_b(n) = 1 + ((n-1) \mod (b-1))$
	\begin{enumerate}
		\item $db_b(x+y) = db_b(db_b(x)+db_b(y))$
		\item $db_b(xy) = db_b(db_b(x)db_b(y))$
		\item $db_b(x-y) \equiv db_b(x)-db_b(y) \pmod{b-1}$
	\end{enumerate}

\section{Important Functions}
 \kactlimport{PrimeCounting.h}
 \kactlimport{MillerRabin.h}
 \kactlimport{Factor.h}
 \subsection{Möbius function}
\[
	\mu(n) = \begin{cases} 0 & n \textrm{ is not square free}\\ (-1)^{\Omega(n)} & \textrm{otherwise}\\\end{cases}
\]
 \[ g(n) = \sum_{1 \leq m \leq n} f\left(\left\lfloor\frac{n}{m}\right \rfloor \right) \Leftrightarrow f(n) = \sum_{1\leq m\leq n} \mu(m)g\left(\left\lfloor\frac{n}{m}\right\rfloor\right)\]
 \[(f*g)(n)= \sum_{d|n}f(d)g\left(\frac{n}{d}\right)\]
 \begin{enumerate}
	\item \textbf{Distributive}: $f*(g+h) = f*g + f*h$
	\item \textbf{Möbius inversion}: $f*1=g \iff g*\mu=f$
 \end{enumerate}

 The most important relations are:
 \begin{align*}
	&\epsilon = 1*\mu & \sigma_1 =\varphi * \sigma_0 \\
	&\Omega = 1_{\mathcal{P}}*1 & \varphi * 1 = Id \\
	&\sigma_k = Id_k* 1 & \sigma_0^3*1 = (\sigma_0 *1)^2 \\
	&\omega = 1_{\mathbb{P}}*1 & |\mu|*1= 2^\omega \\
 \end{align*}
 $\mathcal{P}$ are the prime powers and $\mathbb{P}$ the primes.
\subsection{Multiplicative functions}
	\kactlimport{LinearSieve.h}
	\kactlimport{PrefixSumOpt.h}

	\section{Misc}
	%\kactlimport{FastEratosthenes.h}
	\subsection{Primes}
	$p=962592769$ is such that $2^{21} \mid p-1$, which may be useful. For hashing
	use 970592641 (31-bit number), 31443539979727 (45-bit), 3006703054056749
	(52-bit). $pi(10^6) = 78498$.

	\subsection{Fractions}
		\kactlimport{ContinuedFractions.h}
		\kactlimport{FracBinarySearch.h}

	\subsection{Pythagorean Triples}
	The Pythagorean triples are uniquely generated by
	\[ a=k\cdot (m^{2}-n^{2}),\ \,b=k\cdot (2mn),\ \,c=k\cdot (m^{2}+n^{2}), \]
	with $m > n > 0$, $k > 0$, $m \bot n$, and either $m$ or $n$ even.

% \subsection{Estimates}
% 	$\sum_{d|n} d = O(n \log \log n)$.

% 	The number of divisors of $n$ is at most around 100 for $n < 5e4$, 500 for $n < 1e7$, 2000 for $n < 1e10$, 200\,000 for $n < 1e19$.

